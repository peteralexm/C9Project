---
title: "Largest Russian Cities"
author: "Petr Minin"
date: "3 february 2018 г "
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message = FALSE)
```

This is a map of the largest Russian Cities. The size of the circle corresponds to the population of the city.When you click on the city the popup message shows its name and population as of 01/01/2017.

```{r}
library(leaflet)
cities <- data.frame(population=c(12380664, 5281579, 1602915, 1455514, 1261666, 1231878, 1198858, 1178391, 1169719, 1125299, 1115560, 1082933, 1048005, 1039801, 1015586, 881476, 845300, 744554, 710567, 646277, 633301, 624518, 623736, 616242, 608079, 606589, 592976, 572740, 564443, 556920, 552445, 537622, 532504, 529797, 523726, 510439, 501468, 489498, 485221, 467289, 449063, 433577, 428753, 419363, 418241, 411524, 406933, 406553, 391135, 356168, 355693, 351488, 341892, 341155, 313012, 307911, 306978, 298096, 291687, 290365, 277648, 270774, 249810, 235492, 231602, 225752, 224419, 222594, 209840, 203108, 196406, 194882, 190429, 183996, 181709, 178018, 124447), lat=c(55.755773, 59.938806, 55.028739, 56.838002, 56.323902, 55.795793, 55.159774, 54.989342, 53.195533, 47.227151, 54.734768, 56.008691, 58.004785, 51.661535, 48.707103, 45.023877, 51.531528, 57.153033, 53.511311, 56.852775, 53.356132, 54.317002, 52.286387, 48.472584, 57.626569, 43.134019, 42.984913, 56.495116, 51.76806, 55.359594, 53.786502, 54.619886, 46.347869, 55.743553, 53.194546, 52.61022, 54.079033, 56.1439, 54.193033, 54.4300, 51.730361, 45.044502, 44.616649, 56.859611, 53.411677, 43.581509, 57.000348, 53.2434, 50.597467, 56.129042, 57.910144, 64.539304, 54.507014, 44.952116, 59.220492, 62.027833, 43.024122, 68.969563, 43.317992, 52.721246, 57.767683, 44.723489, 50.54986, 47.708485, 56.151382, 51.498891, 50.290658, 58.521475, 57.819365, 52.541444, 53.895355, 46.959118, 58.13853, 64.558186, 53.720976, 69.349039, 56.908099), lng=c(37.617761, 30.314278, 82.906928, 60.597295, 44.002267, 49.106585, 61.402455, 73.368212, 50.101801, 39.744972, 55.957838, 92.870529, 56.237654, 39.200287, 44.516939, 38.970157, 46.03582, 65.534328, 49.418084, 53.211463, 83.74962, 48.402243, 104.28066, 135.057732, 39.893822, 131.928379, 47.504646, 84.972128, 55.097449, 86.087781, 87.155205, 39.744954, 48.033574, 52.39582, 45.019529, 39.594719, 34.323163, 47.248887, 37.617752, 20.3000, 36.192647, 41.969065, 33.52536, 35.911896, 58.984415, 39.722882, 40.973921, 34.364198, 36.588849, 40.40703, 59.98132, 40.518735, 36.252277, 34.102411, 39.891568, 129.704151, 44.690476, 33.07454, 45.698197, 41.452238, 40.926418, 37.76866, 137.007867, 40.215958, 101.634152, 46.125121, 127.527173, 31.275475, 28.331786, 85.219686, 86.744657, 142.738068, 38.573586, 39.82962, 91.442423, 88.201014, 59.942935))

marks <- c( "</a> Москва 12 380 664</a>", "</a> Санкт-Петербург 5 281 579</a>", "</a> Новосибирск 1 602 915</a>", "</a> Екатеринбург 1 455 514</a>", "</a> Нижний Новгород 1 261 666</a>", "</a> Казань 1 231 878</a>", "</a> Челябинск 1 198 858</a>", "</a> Омск 1 178 391</a>", "</a> Самара 1 169 719</a>", "</a> Ростов-на-Дону 1 125 299</a>", "</a> Уфа 1 115 560</a>", "</a> Красноярск 1 082 933</a>", "</a> Пермь 1 048 005</a>", "</a> Воронеж 1 039 801</a>", "</a> Волгоград 1 015 586</a>", "</a> Краснодар 881 476</a>", "</a> Саратов 845 300</a>", "</a> Тюмень 744 554</a>", "</a> Тольятти 710 567</a>", "</a> Ижевск 646 277</a>", "</a> Барнаул 633 301</a>", "</a> Ульяновск 624 518</a>", "</a> Иркутск 623 736</a>", "</a> Хабаровск 616 242</a>", "</a> Ярославль 608 079</a>", "</a> Владивосток 606 589</a>", "</a> Махачкала 592 976</a>", "</a> Томск 572 740</a>", "</a> Оренбург 564 443</a>", "</a> Кемерово 556 920</a>", "</a> Новокузнецк 552 445</a>", "</a> Рязань 537 622</a>", "</a> Астрахань 532 504</a>", "</a> Набережные Челны 529 797</a>", "</a> Пенза 523 726</a>", "</a> Липецк 510 439</a>", "</a> Киров 501 468</a>", "</a> Чебоксары 489 498</a>", "</a> Тула 485 221</a>", "</a> Калининград 467 289</a>", "</a> Курск 449 063</a>", "</a> Ставрополь 433 577</a>", "</a> Севастополь 428 753</a>", "</a> Тверь 419 363</a>", "</a> Магнитогорск 418 241</a>", "</a> Сочи 411 524</a>", "</a> Иваново 406 933</a>", "</a> Брянск 406 553</a>", "</a> Белгород 391 135</a>", "</a> Владимир 356 168</a>", "</a> Нижний Тагил 355 693</a>", "</a> Архангельск 351 488</a>", "</a> Калуга 341 892</a>", "</a> Симферополь 341 155</a>", "</a> Вологда 313 012</a>", "</a> Якутск 307 911</a>", "</a> Владикавказ 306 978</a>", "</a> Мурманск 298 096</a>", "</a> Грозный 291 687</a>", "</a> Тамбов 290 365</a>", "</a> Кострома 277 648</a>", "</a> Новороссийск 270 774</a>", "</a> Комсомольск-на-Амуре 249 810</a>", "</a> Шахты 235 492</a>", "</a> Братск 231 602</a>", "</a> Энгельс 225 752</a>", "</a> Благовещенск 224 419</a>", "</a> Великий Новгород 222 594</a>", "</a> Псков 209 840</a>", "</a> Бийск 203 108</a>", "</a> Прокопьевск 196 406</a>", "</a> Южно-Сахалинск 194 882</a>", "</a> Рыбинск 190 429</a>", "</a> Северодвинск 183 996</a>", "</a> Абакан 181 709</a>", "</a> Норильск 178 018</a>", "</a> Первоуральск 124 447</a>")

cities %>%
  leaflet() %>%
  addTiles() %>%
  addCircles(weight=1, radius=sqrt(cities$population)*120, popup=marks) 
  
```


